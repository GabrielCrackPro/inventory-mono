<div class="space-y-4">
  <!-- Header Section -->
  <div class="space-y-3">
    <div class="flex items-start justify-between gap-4">
      <div class="space-y-1">
        <h3 class="text-sm font-semibold text-foreground hidden">Customize Your Dashboard</h3>
        <p class="text-xs text-muted-foreground hidden">
          Drag widgets between columns, reorder them, and toggle visibility
        </p>
      </div>
      <z-button
        zType="outline"
        zSize="sm"
        iconName="lucideRotateCcw"
        label="Reset"
        (click)="reset()"
        class="shrink-0"
      />
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-3 gap-2">
      <div class="rounded-lg bg-indigo-500/10 border border-indigo-500/20 p-2">
        <div class="text-xs text-muted-foreground mb-0.5">Main Column</div>
        <div class="text-lg font-bold text-indigo-600 dark:text-indigo-400">
          {{ mainList().length }}
        </div>
      </div>
      <div class="rounded-lg bg-emerald-500/10 border border-emerald-500/20 p-2">
        <div class="text-xs text-muted-foreground mb-0.5">Sidebar</div>
        <div class="text-lg font-bold text-emerald-600 dark:text-emerald-400">
          {{ sideList().length }}
        </div>
      </div>
      <div class="rounded-lg bg-primary/10 border border-primary/20 p-2">
        <div class="text-xs text-muted-foreground mb-0.5">Visible</div>
        <div class="text-lg font-bold text-primary">{{ visibleCount() }}</div>
      </div>
    </div>
  </div>

  <!-- Widget Zones -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <!-- Main Zone Board -->
    <div
      class="rounded-xl border-2 p-4 transition-all duration-300"
      [class]="
        dragOverZone === 'main'
          ? 'border-indigo-500 bg-indigo-500/5 shadow-lg shadow-indigo-500/20'
          : 'border-border/60 bg-linear-to-br from-card to-card/50'
      "
    >
      <div class="flex items-center gap-2 mb-3">
        <div
          class="w-8 h-8 rounded-lg bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center"
        >
          <svg
            class="w-4 h-4 text-indigo-600 dark:text-indigo-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"
            />
          </svg>
        </div>
        <div class="flex-1">
          <div class="text-sm font-semibold text-foreground">Main Column</div>
          <div class="text-xs text-muted-foreground">Primary content area</div>
        </div>
      </div>
      <div
        class="min-h-32 space-y-2.5 transition-all duration-300 rounded-lg p-2"
        [class]="dragOverZone === 'main' ? 'bg-indigo-500/5' : 'bg-muted/20'"
        (dragover)="onDragOver($event)"
        (dragenter)="onDragEnterZone('main')"
        (dragleave)="onDragLeaveZone('main')"
        (drop)="onDropZone('main')"
      >
        @if (mainList().length === 0) {
        <div
          class="h-32 flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-border/40 text-muted-foreground transition-all duration-200 hover:border-indigo-500/40 hover:bg-indigo-500/5"
        >
          <svg
            class="w-8 h-8 mb-2 opacity-40"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
            />
          </svg>
          <p class="text-xs font-medium">Drop widgets here</p>
        </div>
        } @for (m of mainList(); track m.w.id) {
        <div
          class="rounded-lg border bg-background p-2 hover:shadow-md transition-all duration-200 cursor-move"
          [class]="
            m.w.visible
              ? 'border-border/60 hover:border-indigo-500/40'
              : 'border-border/30 opacity-60'
          "
          [class.ring-1]="dragOverZone === 'main' && dragOverIndex === m.index"
          [class.ring-indigo-500]="dragOverZone === 'main' && dragOverIndex === m.index"
          [class.scale-[1.01]]="dragOverZone === 'main' && dragOverIndex === m.index"
          draggable="true"
          (dragstart)="onDragStart(m.index)"
          (dragend)="onDragEnd()"
          (dragover)="onDragOver($event)"
          (dragenter)="onDragEnterCard('main', m.index)"
          (dragleave)="onDragLeaveCard('main', m.index)"
          (drop)="onDropOverCard('main', m.index)"
        >
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-1.5">
              <hia-icon
                name="lucideGripVertical"
                [size]="14"
                class="text-muted-foreground cursor-grab hover:text-foreground transition-colors"
              />
              <span class="font-medium text-xs">{{ m.w.label }}</span>
            </div>
            <z-checkbox
              [checkedInput]="m.w.visible"
              (checkChange)="toggleVisible(m.index, $event)"
            />
          </div>
          <!-- Visual preview (compact) -->
          @if (m.w.id === 'stats') {
          <div class="grid grid-cols-4 gap-1">
            @for (i of [1,2,3,4]; track i) {
            <div
              class="h-6 rounded bg-linear-to-br from-indigo-500/10 to-indigo-500/5 border border-indigo-500/20"
            ></div>
            }
          </div>
          } @else if (m.w.id === 'recent') {
          <div class="space-y-1">
            @for (i of [1,2]; track i) {
            <div class="h-5 rounded bg-muted/40 border border-border/50 flex items-center px-1.5">
              <div class="w-3 h-3 rounded-full bg-muted/60"></div>
            </div>
            }
          </div>
          } @else if (m.w.id === 'graph') {
          <div
            class="h-16 rounded bg-linear-to-br from-muted/30 to-muted/10 border border-border/50"
          >
            <div class="w-full h-full p-1.5 flex items-end gap-0.5">
              @for (i of [1,2,3,4,5,6,7]; track i) {
              <div
                class="flex-1 rounded-t bg-linear-to-t from-indigo-500/40 to-indigo-500/20"
                [style.height.%]="30 + i * 8"
              ></div>
              }
            </div>
          </div>
          }
        </div>
        }
      </div>
    </div>

    <!-- Sidebar Zone Board -->
    <div
      class="rounded-xl border-2 p-4 transition-all duration-300"
      [class]="
        dragOverZone === 'side'
          ? 'border-emerald-500 bg-emerald-500/5 shadow-lg shadow-emerald-500/20'
          : 'border-border/60 bg-linear-to-br from-card to-card/50'
      "
    >
      <div class="flex items-center gap-2 mb-3">
        <div
          class="w-8 h-8 rounded-lg bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center"
        >
          <svg
            class="w-4 h-4 text-emerald-600 dark:text-emerald-400"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"
            />
          </svg>
        </div>
        <div class="flex-1">
          <div class="text-sm font-semibold text-foreground">Sidebar</div>
          <div class="text-xs text-muted-foreground">Secondary content area</div>
        </div>
      </div>
      <div
        class="min-h-32 space-y-2.5 transition-all duration-300 rounded-lg p-2"
        [class]="dragOverZone === 'side' ? 'bg-emerald-500/5' : 'bg-muted/20'"
        (dragover)="onDragOver($event)"
        (dragenter)="onDragEnterZone('side')"
        (dragleave)="onDragLeaveZone('side')"
        (drop)="onDropZone('side')"
      >
        @if (sideList().length === 0) {
        <div
          class="h-32 flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-border/40 text-muted-foreground transition-all duration-200 hover:border-emerald-500/40 hover:bg-emerald-500/5"
        >
          <svg
            class="w-8 h-8 mb-2 opacity-40"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
            />
          </svg>
          <p class="text-xs font-medium">Drop widgets here</p>
        </div>
        } @for (s of sideList(); track s.w.id) {
        <div
          class="rounded-lg border bg-background p-2 hover:shadow-md transition-all duration-200 cursor-move"
          [class]="
            s.w.visible
              ? 'border-border/60 hover:border-emerald-500/40'
              : 'border-border/30 opacity-60'
          "
          [class.ring-1]="dragOverZone === 'side' && dragOverIndex === s.index"
          [class.ring-emerald-500]="dragOverZone === 'side' && dragOverIndex === s.index"
          [class.scale-[1.01]]="dragOverZone === 'side' && dragOverIndex === s.index"
          draggable="true"
          (dragstart)="onDragStart(s.index)"
          (dragend)="onDragEnd()"
          (dragover)="onDragOver($event)"
          (dragenter)="onDragEnterCard('side', s.index)"
          (dragleave)="onDragLeaveCard('side', s.index)"
          (drop)="onDropOverCard('side', s.index)"
        >
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-1.5">
              <hia-icon
                name="lucideGripVertical"
                [size]="14"
                class="text-muted-foreground cursor-grab hover:text-foreground transition-colors"
              />
              <span class="font-medium text-xs">{{ s.w.label }}</span>
            </div>
            <z-checkbox
              [checkedInput]="s.w.visible"
              (checkChange)="toggleVisible(s.index, $event)"
            />
          </div>
          <!-- Visual preview (compact) -->
          @if (s.w.id === 'stock') {
          <div class="space-y-1">
            @for (i of [1,2]; track i) {
            <div
              class="h-5 rounded bg-linear-to-r from-amber-500/10 to-amber-500/5 border border-amber-500/20 flex items-center px-1.5"
            >
              <div class="w-2 h-2 rounded-full bg-amber-500/40"></div>
            </div>
            }
          </div>
          } @else if (s.w.id === 'activity') {
          <div class="space-y-1">
            @for (i of [1,2]; track i) {
            <div
              class="h-5 rounded bg-muted/40 border border-border/50 flex items-center gap-1.5 px-1.5"
            >
              <div class="w-3 h-3 rounded-full bg-muted/60"></div>
              <div class="flex-1 h-1.5 bg-muted/60 rounded"></div>
            </div>
            }
          </div>
          } @else if (s.w.id === 'graph') {
          <div
            class="h-16 rounded bg-linear-to-br from-muted/30 to-muted/10 border border-border/50"
          >
            <div class="w-full h-full p-1.5 flex items-end gap-0.5">
              @for (i of [1,2,3,4,5,6,7]; track i) {
              <div
                class="flex-1 rounded-t bg-linear-to-t from-emerald-500/40 to-emerald-500/20"
                [style.height.%]="30 + i * 8"
              ></div>
              }
            </div>
          </div>
          }
        </div>
        }
      </div>
    </div>
  </div>

  <!-- Footer Note -->
  <div
    class="flex items-center gap-2 text-[10px] text-muted-foreground bg-muted/30 rounded-lg p-2 border border-border/40"
  >
    <svg class="w-3 h-3 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
    </svg>
    <span>Changes saved when you click Save</span>
  </div>
</div>
