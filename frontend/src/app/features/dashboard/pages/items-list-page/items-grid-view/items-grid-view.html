<div class="h-full overflow-auto">
  @if (selectMode) {
  <div class="flex items-center gap-2 p-2 sticky top-0 bg-background z-10 border-b">
    <input
      type="checkbox"
      class="h-4 w-4"
      [checked]="items.length > 0 && selectedIds.length === items.length"
      [indeterminate]="selectedIds.length > 0 && selectedIds.length < items.length"
      (change)="toggleSelectAll.emit($any($event.target).checked)"
    />
    <span class="text-xs text-muted-foreground">Select all</span>
  </div>
  }
  <div class="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 p-2">
  @for (item of items; track item.id) {
  <z-card
    class="rounded-xl transition-colors hover:bg-accent/30 cursor-pointer"
    [routerLink]="['/dashboard/items', item.id]"
    (click)="onCardClick(item, $event)"
  >
    <div class="p-3">
      <div class="flex items-center justify-between gap-2">
        <div class="font-medium truncate text-sm">{{ item.name }}</div>
        <span
          class="text-[10px] px-1.5 py-0.5 rounded-full border border-border/50 text-muted-foreground shrink-0"
          >{{ item.quantity }}{{ item.unit ? ' ' + item.unit : '' }}</span
        >
      </div>
      @if (selectMode) {
      <div class="mt-2">
        <label class="inline-flex items-center gap-2">
          <input
            type="checkbox"
            class="h-4 w-4"
            [checked]="selectedIds.includes(item.id)"
            (click)="$event.stopPropagation()"
            (change)="toggleSelect.emit({ id: item.id, selected: $any($event.target).checked })"
          />
          <span class="text-xs text-muted-foreground">Select</span>
        </label>
      </div>
      }
      <div class="mt-2 flex items-center gap-2 overflow-hidden">
        @if (item.room?.name) {
        <span
          class="inline-flex items-center px-1.5 py-0.5 rounded-md bg-muted/60 text-muted-foreground text-[11px] truncate max-w-[45%]"
        >
          <hia-icon name="Warehouse" class="h-3.5 w-3.5 mr-1" />
          <span class="truncate">{{ item.room?.name }}</span>
        </span>
        } @if (item.category?.name) {
        <span
          class="inline-flex items-center px-1.5 py-0.5 rounded-md bg-muted/60 text-muted-foreground text-[11px] truncate max-w-[45%]"
        >
          <hia-icon name="Tag" class="h-3.5 w-3.5 mr-1" />
          <span class="truncate">{{ item.category?.name }}</span>
        </span>
        }
      </div>
    </div>
  </z-card>
  }
  </div>
</div>
