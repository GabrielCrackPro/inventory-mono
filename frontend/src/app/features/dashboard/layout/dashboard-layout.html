<div class="min-h-screen flex flex-col">
  <!-- Sticky Header -->
  <hia-header />

  <!-- Main Layout -->
  <div class="flex-1 flex overflow-hidden">
    <z-sidebar
      [zWidth]="240"
      [zCollapsible]="true"
      [zCollapsed]="sidebarCollapsed()"
      [zCollapsedWidth]="64"
      (zCollapsedChange)="onCollapsedChangeAndReposition($event)"
      class="h-[calc(100vh-64px)]"
    >
      <!-- Sidebar Header -->
      <div slot="header" class="px-4 py-4 border-b border-border/50">
        @if (!sidebarCollapsed()) {
        <div class="text-xs font-semibold text-muted-foreground uppercase tracking-wider">Menu</div>
        }
      </div>

      <!-- Navigation -->
      <nav
        #sidebarNav
        role="navigation"
        aria-label="Main navigation"
        class="relative flex-1 px-2 py-4 space-y-1"
        (mouseleave)="leaveHover()"
      >
        @if (!sidebarCollapsed() && hoverEffect().visible) {
        <div
          class="absolute z-0 rounded-md bg-primary/15 ring-1 ring-primary/20 shadow-sm backdrop-blur-[2px] transition-all duration-200 pointer-events-none"
          [style.top.px]="hoverEffect().top"
          [style.left.px]="hoverEffect().left"
          [style.width.px]="hoverEffect().width"
          [style.height.px]="hoverEffect().height"
          aria-hidden="true"
        ></div>
        }
        <!-- Navigation Items -->
        <z-sidebar-group>
          <z-sidebar-group-label [collapsed]="sidebarCollapsed()">
            Navigation
          </z-sidebar-group-label>

          @for (item of items; track item.label) {
          <hia-nav-item
            #itemContainer
            [label]="item.label"
            [icon]="item.icon"
            [route]="item.to"
            [collapsed]="sidebarCollapsed()"
            [exact]="item.to === ''"
            [attr.data-to]="item.to"
            (onHover)="moveHover($event, itemContainer.nativeElement)"
          />
          }
        </z-sidebar-group>

        <!-- Quick Actions -->
        @if (!sidebarCollapsed()) {
        <z-sidebar-group>
          <z-sidebar-group-label>Quick Actions</z-sidebar-group-label>

          <hia-nav-item
            label="Add Item"
            icon="Plus"
            [collapsed]="sidebarCollapsed()"
            routerLink="items/new"
            class="text-primary hover:text-primary"
          />
        </z-sidebar-group>
        }
      </nav>
    </z-sidebar>

    <!-- Main Content -->
    <main class="flex-1 overflow-auto bg-background">
      <div class="mx-auto max-w-7xl p-6">
        <router-outlet />
      </div>
    </main>
  </div>
</div>
