<div class="min-h-screen flex flex-col">
  <!-- Header (can be pinned or unpinned) -->
  <hia-header class="header-pinned" />

  <!-- Main Layout -->
  <div class="flex-1 flex overflow-hidden" [class.pt-[72px]]="isHeaderPinned()">
    <z-sidebar
      [zWidth]="240"
      [zCollapsible]="true"
      [zCollapsed]="sidebarCollapsed()"
      [zCollapsedWidth]="64"
      [zPosition]="'left'"
      (zCollapsedChange)="onCollapsedChangeAndReposition($event)"
    >
      <!-- Logo Section -->
      <div
        class="px-4 py-6 border-b border-border/50 transition-all duration-300 ease-in-out"
        [class.px-2]="sidebarCollapsed()"
        [class.justify-center]="sidebarCollapsed()"
      >
        <hia-logo
          [size]="32"
          [variant]="sidebarCollapsed() ? 'icon-only' : 'compact'"
          [showText]="!sidebarCollapsed()"
        />
      </div>

      <!-- Navigation -->
      <nav
        #sidebarNav
        role="navigation"
        aria-label="Main navigation"
        class="relative flex-1 px-2 py-4 space-y-1 overflow-y-auto"
        (mouseleave)="leaveHover()"
      >
        @if (!sidebarCollapsed() && hoverEffect().visible) {
        <div
          class="absolute z-0 rounded-md bg-primary/15 ring-1 ring-primary/20 shadow-sm backdrop-blur-[2px] transition-all duration-300 ease-out pointer-events-none"
          [style.top.px]="hoverEffect().top"
          [style.left.px]="hoverEffect().left"
          [style.width.px]="hoverEffect().width"
          [style.height.px]="hoverEffect().height"
          [style.opacity]="hoverEffect().opacity"
          aria-hidden="true"
        ></div>
        }
        <!-- Navigation Items -->
        <z-sidebar-group>
          <z-sidebar-group-label [collapsed]="sidebarCollapsed()">
            Navigation
          </z-sidebar-group-label>

          @for (item of items; track item.label) {
          <hia-nav-item
            #itemContainer
            [label]="item.label"
            [icon]="item.icon"
            [route]="item.to"
            [collapsed]="sidebarCollapsed()"
            [exact]="item.to === '/'"
            [attr.data-to]="item.to"
            (onHover)="moveHover($event, itemContainer.nativeElement)"
          />
          }
        </z-sidebar-group>

        <!-- Quick Actions -->
        @if (!sidebarCollapsed()) {
        <z-sidebar-group>
          <z-sidebar-group-label>Quick Actions</z-sidebar-group-label>

          <hia-nav-item
            label="Add Item"
            icon="lucidePlus"
            [collapsed]="sidebarCollapsed()"
            routerLink="items/new"
            class="text-primary hover:text-primary"
          />
        </z-sidebar-group>
        }
      </nav>
    </z-sidebar>

    <!-- Main Content - Scroll container moved here -->
    <div class="flex-1 flex flex-col overflow-y-auto bg-background">
      <main class="flex-1">
        <div class="mx-auto max-w-7xl p-6">
          <hia-dashboard-alerts />
          <router-outlet />
        </div>
      </main>
    </div>
  </div>
</div>
